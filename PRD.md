# 키움 API 기반 섹터 연동 증권 거래 시스템 PRD

## Executive Summary

### 프로젝트 명
**Global Sector Linked Trading System (GSLTS)**  
*글로벌 시장 흐름을 읽어 한국 증시를 앞서가는 스마트 트레이딩 플랫폼*

### 한 줄 요약
미국 섹터의 전일 흐름을 분석하여 한국 증시 개장 전 매매 전략을 수립하고, 거래대금 기반 유동성 종목을 자동 선정하여 체계적 매매를 지원하는 통합 거래 시스템

---

## 1. 문제 정의 (Problem Statement)

### 1.1 개인 투자자가 직면한 현실

**"정보의 비대칭성"**
- 기관/외국인은 글로벌 시장 분석팀과 실시간 데이터를 활용
- 개인 투자자는 단편적 정보로 감에 의존한 매매
- 한국 증시는 미국 시장의 영향을 크게 받지만, 이를 체계적으로 활용하는 도구 부재

**"종목 선정의 어려움"**
- KOSPI/KOSDAQ 2,500여 개 종목 중 어떤 종목을 거래해야 할지 모름
- 뉴스와 커뮤니티 정보에 의존하다 늦은 진입으로 손실
- 거래량이 적은 종목 매매로 체결 불가 또는 큰 슬리피지 발생

**"매매 실행의 번거로움"**
- 키움 HTS는 정보 확인과 주문 실행을 위해 수십 개 창을 열어야 함
- 차트 분석 → 호가 확인 → 주문 입력의 반복 작업으로 기회 상실
- 틱데이터 기반 백테스팅 불가능으로 전략 검증 어려움

### 1.2 시장 기회

| 통계 | 의미 |
|------|------|
| 한국-미국 주식시장 상관계수 0.7+ | 미국 시장 흐름이 한국 증시에 높은 예측력 보유 |
| 거래대금 상위 20% 종목이 전체 거래의 80% | 소수의 고유동성 종목 집중으로 효율적 매매 가능 |
| 개인 투자자 계좌 수 1,400만+ | 대규모 타겟 시장 존재 |
| HTS 불만족도 65% (자체 조사) | 더 나은 거래 도구에 대한 수요 |

---

## 2. 솔루션 개요 (Solution Overview)

### 2.1 핵심 아이디어

**"미국이 어제 움직인 방향으로, 한국은 오늘 움직인다"**

```
미국 전일 Technology 섹터 +2.5% ▲
         ↓
한국 오늘 IT/반도체 섹터 상승 예상
         ↓
거래대금 TOP 종목 자동 필터링
         ↓
삼성전자, SK하이닉스, 네이버 등 매수 후보 제시
         ↓
실시간 차트/호가창으로 최적 진입점 포착
         ↓
원클릭 매매 실행
```

### 2.2 차별화 포인트

| 기존 HTS/MTS | GSLTS |
|--------------|-------|
| 단순 정보 제공 | **전략 자동 생성** (미국 섹터 → 한국 종목) |
| 모든 종목 나열 | **거래대금 기반 스마트 필터링** |
| 복잡한 UI, 수십 개 창 | **통합 대시보드 원페이지 거래** |
| 과거 데이터 부재 | **틱데이터 수집 및 백테스팅 지원** |
| 정적 차트 | **4등분 가격 라인으로 직관적 매매 타이밍** |

### 2.3 제공 가치

**트레이더 입장**
- ✅ 매일 아침 8시, AI가 분석한 오늘의 유망 섹터와 종목 리스트 확인
- ✅ 거래대금 TOP 50 실시간 모니터링으로 시장의 주인공 파악
- ✅ 통합 차트+호가창으로 매매 속도 3배 향상
- ✅ 과거 틱데이터로 내 전략 검증 후 실전 투입

**비즈니스 입장**
- 💰 정보 격차 해소로 개인 투자자의 수익률 개선 기여
- 💰 자동화로 시간 절약 → 더 많은 분석과 학습 가능
- 💰 틱데이터 축적 → 프리미엄 구독 서비스화 가능
- 💰 커뮤니티 기능 추가 시 소셜 트레이딩 플랫폼으로 확장

---

## 3. 타겟 사용자 (Target Users)

### 3.1 Primary User

**"직장인 스윙/데이 트레이더" (25-45세)**
- 업무 중 수시로 시장 모니터링 불가
- 퇴근 후 미국 시장 분석 → 다음날 한국 시장 전략 수립
- 거래 경험 1년 이상, 기본적 기술적 분석 이해
- 월 평균 거래 횟수: 10~30회
- 투자 금액: 1,000만~5,000만원

**페르소나: "김데이" (35세, IT 개발자)**
> "회사 다니면서 주식 하는데, HTS 창 10개 띄워놓고 매매하다 보면 집중 안 돼요. 미국 장 보고 한국 장 예측하는데 체계적인 도구가 없어서 항상 감으로 하거든요. 차트 보면서 바로 주문 넣고, 내 전략이 과거에 먹혔는지 테스트해보고 싶어요."

### 3.2 Secondary User

**"퀀트 트레이더/알고리즘 개발자"**
- 틱데이터 기반 전략 개발 및 백테스팅 필요
- API 연동하여 자동매매 시스템 구축 관심

**"신규 투자자"**
- 어떤 종목을 사야 할지 모르는 초보자
- 시스템이 추천하는 종목 리스트로 학습 시작

---

## 4. 핵심 기능 (Core Features)

### 4.1 스마트 종목 추천 엔진

**[오전 8시, 자동 생성되는 오늘의 전략]**

```
📊 오늘의 섹터 분석 (2025-11-14)
━━━━━━━━━━━━━━━━━━━━━━━━━━━
🇺🇸 미국 전일 TOP 섹터
1. Technology (XLK) +2.8% ⬆️
2. Healthcare (XLV) +1.5% ⬆️
3. Energy (XLE) -1.2% ⬇️

🇰🇷 한국 유망 섹터 (예상)
1. IT/반도체 ⬆️ 강세 예상
2. 제약/바이오 ⬆️ 상승 가능
3. 에너지/정유 ⬇️ 약세 예상

💎 추천 종목 (거래대금 TOP 기준)
[IT/반도체]
- 삼성전자 (005930) | 거래대금 1위
- SK하이닉스 (000660) | 거래대금 3위
- NAVER (035420) | 거래대금 8위

[제약/바이오]
- 삼성바이오로직스 (207940) | 거래대금 15위
```

### 4.2 통합 트레이딩 대시보드

**[한 화면에서 모든 것을]**

```
┌─────────────────────────────────────────────────────────┐
│  [삼성전자 005930]  70,200원 ▼-800 (-1.13%)            │
├─────────────────────┬───────────────────────────────────┤
│                     │    [실시간 호가창]                 │
│   [차트 영역]        │  매도 70,400  1,234주 ■■■■■    │
│                     │  매도 70,300  2,456주 ■■■■■■  │
│  ┌───────────────┐  │  매도 70,200  5,678주 ■■■■■■■■│
│  │ 캔들스틱       │  │  ━━━━━━━━━━━━━━━━━━━━━━━━━   │
│  │               │  │  매수 70,100  3,456주 ■■■■■■  │
│  │ 고가 ━━━━━━   │  │  매수 70,000  4,567주 ■■■■■   │
│  │ 75%  ┄┄┄┄┄┄   │  │  매수 69,900  2,345주 ■■■     │
│  │ 50%  ┄┄┄┄┄┄   │  │                                 │
│  │ 25%  ┄┄┄┄┄┄   │  ├─────────────────────────────────┤
│  │ 저가 ━━━━━━   │  │  [주문 패널]                     │
│  │               │  │  [매수] [매도]                   │
│  └───────────────┘  │  가격: 70,100  수량: 10주        │
│                     │  [주문하기] [정정] [취소]         │
└─────────────────────┴───────────────────────────────────┘
```

**특징:**
- 차트 보면서 즉시 주문 (클릭 2회로 매매 완료)
- 4등분 가격 라인으로 매매 타이밍 직관적 파악
- 실시간 호가 잔량 시각화로 수급 판단

### 4.3 거래대금 실시간 랭킹

**[지금 시장에서 가장 뜨거운 종목은?]**

| 순위 | 종목명 | 현재가 | 등락률 | 거래대금 | 섹터 |
|------|--------|--------|--------|----------|------|
| 1 | 삼성전자 | 70,200 | -1.13% | 1.2조 | IT |
| 2 | SK하이닉스 | 128,500 | +2.34% | 8,500억 | 반도체 |
| 3 | NAVER | 185,000 | +0.81% | 5,200억 | 인터넷 |

- 클릭 시 해당 종목 차트 자동 로딩
- 섹터별 필터링으로 관심 업종 집중 모니터링
- 10분마다 자동 갱신

### 4.4 틱데이터 수집 및 백테스팅

**[당신의 전략, 과거에도 통했을까?]**

- 모든 거래 종목의 틱(Tick) 단위 데이터 자동 저장
- 백테스팅 엔진으로 과거 3개월~1년 전략 검증
- "만약 이 전략을 작년에 썼다면 수익률 XX%" 시뮬레이션

---

## 5. 비즈니스 모델

### 5.1 수익 모델

**Phase 1: 무료 (MVP)**
- 기본 매매 기능 무료 제공
- 사용자 확보 및 피드백 수집 집중

**Phase 2: 프리미엄 구독 (월 29,000원)**
- ✅ 섹터 기반 AI 종목 추천
- ✅ 거래대금 TOP 100 실시간 제공
- ✅ 틱데이터 무제한 조회 및 다운로드
- ✅ 백테스팅 엔진 사용
- ✅ 실시간 알림 (가격, 체결, 뉴스)

**Phase 3: API 서비스 (월 50,000원~)**
- REST API 제공으로 자동매매 시스템 구축 지원
- 틱데이터 API 판매

### 5.2 시장 규모 추정

- 국내 주식 투자자: 약 1,400만 명
- 이 중 능동적 트레이더: 약 200만 명 (14%)
- 타겟 시장 (유료 전환 가능): 20만 명 (1%)
- 예상 전환율 5% 시: 10,000명 × 29,000원 = **월 2.9억원**

---

## 6. 성공 지표 (Success Metrics)

### 6.1 사용자 지표

| 지표 | 목표 (3개월) | 목표 (6개월) | 측정 방법 |
|------|--------------|--------------|-----------|
| MAU (월간 활성 사용자) | 500명 | 2,000명 | 로그인 사용자 수 |
| 일평균 거래 건수 | 50건 | 300건 | 주문 체결 건수 |
| 사용자 체류 시간 | 15분 | 30분 | 세션 시간 |
| 유료 전환율 | - | 3% | 결제 사용자/전체 사용자 |

### 6.2 시스템 지표

| 지표 | 목표 | 중요도 |
|------|------|--------|
| 주문 체결 지연 | 1초 이내 | ⭐⭐⭐ |
| 틱데이터 수집 정확도 | 99% 이상 | ⭐⭐⭐ |
| 시스템 가동률 | 99.5% | ⭐⭐⭐ |
| 차트 업데이트 지연 | 500ms 이내 | ⭐⭐ |

### 6.3 비즈니스 지표

- **섹터 추천 정확도**: 백테스트 기준 수익률 연 10% 이상
- **사용자 만족도**: NPS 50+ (추천 의향)
- **이탈률**: 월 20% 이하

---

## 7. 개발 로드맵

### 7.1 Phase 1: MVP (4주) ✅ 필수 기능

**목표: "일단 거래는 할 수 있게"**

- 키움 API 연동 (로그인, 잔고 조회)
- 기본 주문/정정/취소 기능
- 실시간 차트 (일봉, 분봉)
- 실시간 호가창
- 종목 검색

**성공 기준**: 최소 10명의 베타 테스터가 실제 거래 가능

### 7.2 Phase 2: 핵심 차별화 (3주) 🎯 핵심 가치

**목표: "우리만의 무기 장착"**

- 미국 섹터 데이터 자동 수집
- 섹터 기반 종목 추천 엔진
- 거래대금 실시간 랭킹
- 4등분 가격 라인 차트

**성공 기준**: 사용자 50명, "이거 없으면 안 쓰겠다" 피드백 10건 이상

### 7.3 Phase 3: 데이터 인프라 (4주) 📊 장기 경쟁력

**목표: "데이터가 자산이 되게"**

- Sub Server 틱데이터 수집 시스템
- 시계열 DB 구축 및 최적화
- 백테스팅 엔진 v1.0

**성공 기준**: 일 10GB 틱데이터 안정적 수집, 백테스트 1회 실행

### 7.4 Phase 4: 프리미엄 기능 (진행 중) 💰 수익화

**목표: "유료 고객 확보"**

- 프리미엄 구독 모델 런칭
- 모바일 앱 (React Native)
- API 서비스 오픈
- 커뮤니티 기능 (선택)

**성공 기준**: 유료 사용자 100명, 월 290만원 MRR

---

## 8. 리스크 및 대응 전략

### 8.1 기술적 리스크

| 리스크 | 영향도 | 대응 전략 |
|--------|--------|-----------|
| 키움 API 장애 | 🔴 높음 | - 대체 브로커 API 준비 (한국투자증권)<br>- 사전 알림 시스템 |
| 실시간 데이터 폭주 | 🟡 중간 | - 버퍼링 + 비동기 처리<br>- Sub Server 분리 |
| 서버 다운 | 🔴 높음 | - 이중화 구성<br>- 자동 재시작 |

### 8.2 비즈니스 리스크

| 리스크 | 영향도 | 대응 전략 |
|--------|--------|-----------|
| 섹터 상관관계 약화 | 🟡 중간 | - 다양한 보조 지표 제공<br>- 사용자 교육 강화 |
| 경쟁사 등장 | 🟡 중간 | - 빠른 MVP 출시로 선점<br>- 틱데이터 자산화 |
| 규제 변경 | 🟢 낮음 | - API 약관 정기 모니터링<br>- 법률 자문 |

### 8.3 대응 우선순위

1. **시스템 안정성 최우선**: 돈이 걸린 서비스이므로 장애 발생 시 신뢰 즉시 상실
2. **빠른 출시 > 완벽한 기능**: MVP 4주 내 출시, 피드백 받으며 개선
3. **데이터 자산화**: 틱데이터는 시간이 지날수록 가치 상승, 초기부터 수집

---

## 9. 향후 비전

### 9.1 단기 (6개월)
"한국에서 가장 똑똑한 개인 트레이더 도구"
- 사용자 2,000명, MAU 500명
- 섹터 기반 추천으로 차별화 인지도 확보

### 9.2 중기 (1년)
"데이터 기반 트레이딩 플랫폼"
- 유료 사용자 1,000명 (MRR 2,900만원)
- 틱데이터 기반 퀀트 전략 마켓플레이스
- 미국 주식 직접 거래 지원 (IB API)

### 9.3 장기 (2년+)
"글로벌 소셜 트레이딩 플랫폼"
- 커뮤니티 기능으로 트레이더 간 전략 공유
- AI 자동매매 에이전트 제공
- 아시아 시장 확장 (일본, 중국, 홍콩)

---

## 10. 팀 및 리소스

### 10.1 필요 인력

| 역할 | 인원 | 주요 역할 |
|------|------|-----------|
| 풀스택 개발자 | 2명 | Frontend (React) + Backend (Python/FastAPI) |
| 데이터 엔지니어 | 1명 | 틱데이터 수집, DB 최적화, Sub Server 관리 |
| 퀀트 개발자 (선택) | 1명 | 백테스팅 엔진, 전략 알고리즘 |
| 디자이너 (외주 가능) | 0.5명 | UI/UX 디자인 |

### 10.2 개발 환경

- **서버**: AWS EC2 또는 네이버 클라우드 (국내 레이턴시 중요)
- **데이터베이스**: MariaDB (시계열 최적화), Redis (실시간 캐싱)
- **모니터링**: Grafana + Prometheus
- **예상 비용**: 월 50~100만원 (초기)

---

## 부록: FAQ

### Q1. 키움증권 계좌가 없어도 사용 가능한가요?
A. MVP는 키움증권 계좌 필수입니다. 추후 한국투자증권 등 타 브로커 지원 예정입니다.

### Q2. 자동매매가 가능한가요?
A. Phase 1은 반자동(추천 종목 제시 + 수동 체결)입니다. Phase 4에서 API를 통한 완전 자동매매 지원 예정입니다.

### Q3. 미국 섹터 데이터는 어디서 가져오나요?
A. 무료 API (Yahoo Finance, Alpha Vantage) 또는 유료 데이터 제공업체를 사용합니다.

### Q4. 모바일에서도 사용 가능한가요?
A. Phase 1은 웹 기반입니다. Phase 4에서 React Native 기반 모바일 앱 출시 예정입니다.

---

**문서 버전**: 2.0 (Overview-Focused)  
**최종 수정일**: 2025-11-14  
**작성자**: Na  
**승인자**: -  
**다음 리뷰**: Phase 1 완료 시

---

## 3. 시스템 구조 개요

### 3.1 이중 서버 아키텍처

**왜 서버를 두 개로 나누나요?**

매매와 데이터 수집은 별개의 임무입니다. 데이터 수집 중 문제가 생겨도 매매는 계속되어야 하고, 매매 시스템 업데이트 중에도 데이터는 끊김없이 수집되어야 합니다.

```
사용자
  ↓
[Main Server: 매매 전용]
  - 차트 보여주기
  - 주문 실행
  - 전략 추천
  ↓ ↑ (데이터 요청/수신)
[Sub Server: 데이터 전용]
  - 24시간 틱데이터 수집
  - 데이터베이스 저장
  - 과거 데이터 제공
  ↓
[키움 API]
```

**Main Server (거래 담당)**
- 사용자가 보는 화면
- 주문/정정/취소 처리
- 미국 섹터 분석 → 한국 종목 추천

**Sub Server (데이터 담당)**
- 조용히 백그라운드에서 틱데이터 수집
- 데이터베이스 관리
- Main Server 요청 시 데이터 제공

### 3.2 핵심 기술 스택 (간단히)

| 구분 | 기술 | 이유 |
|------|------|------|
| 화면 | React + TradingView | 빠르고 예쁜 차트 |
| 서버 | Python FastAPI | 키움 API와 궁합 좋음 |
| 데이터베이스 | MariaDB | 시계열 데이터에 최적화 |
| 실시간 통신 | WebSocket | 지연 없는 데이터 전송 |

---

## 11. 기술 구현 상세 (Technical Appendix)

### 11.1 미국-한국 섹터 매핑 테이블

| 미국 섹터 | 섹터 ETF | 한국 대응 섹터 | 대표 종목 |
|----------|---------|---------------|-----------|
| Technology | XLK | IT, 반도체 | 삼성전자, SK하이닉스, 네이버 |
| Financial | XLF | 금융 | KB금융, 신한지주 |
| Energy | XLE | 에너지, 정유 | SK이노베이션, S-Oil |
| Healthcare | XLV | 제약, 바이오 | 삼성바이오로직스, 셀트리온 |
| Industrial | XLI | 산업재 | 현대중공업, 두산 |
| Consumer Staples | XLP | 필수소비재 | CJ제일제당, 오리온 |
| Consumer Discretionary | XLY | 자동차, 유통 | 현대차, 롯데쇼핑 |
| Utilities | XLU | 유틸리티 | 한국전력, 한국가스공사 |
| Materials | XLB | 화학, 소재 | LG화학, 포스코케미칼 |
| Real Estate | XLRE | 부동산 | 롯데리츠, 신한알파리츠 |
| Communication | XLC | 통신 | SK텔레콤, KT |

### 11.2 데이터베이스 스키마 (핵심만)

**거래대금 랭킹 테이블**
```sql
CREATE TABLE trading_volume_rank (
  stock_code VARCHAR(10),
  stock_name VARCHAR(50),
  sector VARCHAR(50),
  trading_value BIGINT,  -- 거래대금
  rank_position INT,
  collected_at DATETIME
);
```

**틱데이터 테이블**
```sql
CREATE TABLE tick_data (
  stock_code VARCHAR(10),
  tick_time DATETIME(3),  -- 밀리초 단위
  price INT,
  volume INT,
  strength TINYINT  -- 체결강도
);
```

**주문 테이블**
```sql
CREATE TABLE orders (
  order_no VARCHAR(20),
  stock_code VARCHAR(10),
  order_type ENUM('BUY', 'SELL'),
  order_price INT,
  order_quantity INT,
  order_status ENUM('PENDING', 'COMPLETED', 'CANCELLED'),
  order_time DATETIME
);
```

### 11.3 핵심 알고리즘 (의사코드)

**종목 선정 로직**
```python
def select_stocks_for_today():
    # 1. 미국 섹터 등락률 가져오기
    us_sectors = get_us_sector_performance()
    
    # 2. 상승률 TOP 3 섹터 선택
    top_sectors = us_sectors.sort_by('change_rate').top(3)
    
    # 3. 해당 섹터의 한국 종목 추출
    kr_stocks = []
    for sector in top_sectors:
        mapped_sector = SECTOR_MAPPING[sector.name]
        stocks = get_stocks_by_sector(mapped_sector)
        kr_stocks.extend(stocks)
    
    # 4. 거래대금 상위 20% 필터링
    high_volume_stocks = filter_by_trading_volume(kr_stocks, percentile=80)
    
    # 5. 최종 추천 (5~10종목)
    return high_volume_stocks.top(10)
```

**4등분 가격 라인 계산**
```python
def calculate_quarter_lines(stock_code):
    today_open = get_today_open(stock_code)
    today_high = get_today_high(stock_code)
    today_low = get_today_low(stock_code)
    
    price_range = today_high - today_low
    
    return {
        'high': today_high,
        'q3': today_low + (price_range * 0.75),
        'mid': today_low + (price_range * 0.50),
        'q1': today_low + (price_range * 0.25),
        'low': today_low,
        'open': today_open
    }
```

### 11.4 실시간 데이터 흐름

**장 중 데이터 처리 (초당)**
```
키움 API (틱 발생)
      ↓
Sub Server 버퍼 (10,000건 모음)
      ↓
DB 일괄 저장 (10초마다)
      ↓
WebSocket으로 Main Server 전송
      ↓
사용자 화면 업데이트
```

**성능 최적화 포인트**
- 버퍼링: 개별 저장 대신 10초마다 일괄 저장 (DB 부하 ↓)
- 인덱싱: `(stock_code, tick_time)` 복합 인덱스
- 파티셔닝: 일별 파티션으로 조회 속도 향상
- 캐싱: Redis로 최근 1분 데이터 메모리 캐싱

---

## 12. 다음 단계 (Next Steps)

### 12.1 즉시 착수 (이번 주)
- [ ] 개발 환경 세팅 (AWS/네이버 클라우드 계정 생성)
- [ ] 키움증권 모의투자 계좌 개설
- [ ] Git 저장소 생성 및 초기 프로젝트 구조 세팅

### 12.2 Phase 1 착수 (다음 주~)
- [ ] 키움 OpenAPI+ 설치 및 로그인 테스트
- [ ] React 프로젝트 생성 및 기본 레이아웃
- [ ] 주문 API 연동 (매수/매도)

### 12.3 의사결정 필요 사항
- [ ] 서버 인프라: AWS vs 네이버 클라우드?
- [ ] 차트 라이브러리: TradingView (유료) vs Lightweight Charts (무료)?
- [ ] MVP 출시 후 유료화 시점?


